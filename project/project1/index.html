<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Gareth Meredith" />
    
    <link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico">
    <title>Project 1: Covid Vaccination Response</title>
    <meta name="generator" content="Hugo 0.83.1" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="/css/main.css" />
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,200bold,400old" />
    
    <!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
			<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->

    
  </head>

  <body>
    <div id="wrap">
      
      <nav class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <a class="navbar-brand" href="/"><i class="fa fa-home"></i></a>
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div class="navbar-collapse collapse" id="navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
        <li><a href="/post/">BLOG</a></li>
        
        <li><a href="/project/">PROJECTS</a></li>
        
        <li><a href="/resume/">RESUME</a></li>
        
      
      </ul>
    </div>
  </div>
</nav>

      <div class="container">
        <div class="blog-post">
          <h3>
            <strong><a href="/project/project1/">Project 1: Covid Vaccination Response</a></strong>
          </h3>
        </div>
 
<div class="blog-title">
          <h4>
         January 1, 0001 
            &nbsp;&nbsp;
            
          </h4>
        </div>

        <div class="panel panel-default">
          <div class="panel-body">
            <div class="blogpost">
              
<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In this R markdown document, I will be exploring the Covid vaccination response of all countries of the world and how the demographics of these countries impact their responses. To do this, I will first need a relatively up-to-date dataset containing Covid vaccination data for the whole world. Luckily for me, the website kaggle had precisely the dataset I was looking for. In addition to this vaccinations dataset, I needed a dataset containing as much demographic information as possible for each country of the world. For this, once again kaggle had my back.</p>
<p>With the two datasets I needed decided upon, I will now describe my plan for analyzing this data. Since the dataset resulting from the merging of these two dataframes will be huge, I’ve decided that for all analysis that does not depend on time I will filter the dataset down to a uniform date, March 1st. This step is a neccessity, especially when summarizing based on region/country, because one country may have an entry for every day between Jan 1st and March 1st so summarizing over all those entries has the strong potential to produce inaccurate results.</p>
<p>With all that being said, I’m very excited to get started on this analysis and to share my results. I anticipate that more developed nations will see a markedly better vaccination response than less developed nations, but, the interesting thing about this Covid-19 pandemic is that it’s tough to infer about something that is unprecedented.</p>
<pre class="r"><code>library(tidyverse)
library(stringr)</code></pre>
</div>
<div id="the-datasets" class="section level2">
<h2>The Datasets</h2>
<pre class="r"><code>countries &lt;- read.csv(&quot;countries of the world.csv&quot;)
vaccinations &lt;- read.csv(&quot;country_vaccinations.csv&quot;)

glimpse(countries)</code></pre>
<pre><code>## Rows: 227
## Columns: 20
## $ Country                            &lt;chr&gt; &quot;Afghanistan &quot;, &quot;Albania &quot;, &quot;Algeri~
## $ Region                             &lt;chr&gt; &quot;ASIA (EX. NEAR EAST)         &quot;, &quot;E~
## $ Population                         &lt;int&gt; 31056997, 3581655, 32930091, 57794,~
## $ Area..sq..mi..                     &lt;int&gt; 647500, 28748, 2381740, 199, 468, 1~
## $ Pop..Density..per.sq..mi..         &lt;chr&gt; &quot;48,0&quot;, &quot;124,6&quot;, &quot;13,8&quot;, &quot;290,4&quot;, &quot;~
## $ Coastline..coast.area.ratio.       &lt;chr&gt; &quot;0,00&quot;, &quot;1,26&quot;, &quot;0,04&quot;, &quot;58,29&quot;, &quot;0~
## $ Net.migration                      &lt;chr&gt; &quot;23,06&quot;, &quot;-4,93&quot;, &quot;-0,39&quot;, &quot;-20,71&quot;~
## $ Infant.mortality..per.1000.births. &lt;chr&gt; &quot;163,07&quot;, &quot;21,52&quot;, &quot;31&quot;, &quot;9,27&quot;, &quot;4~
## $ GDP....per.capita.                 &lt;int&gt; 700, 4500, 6000, 8000, 19000, 1900,~
## $ Literacy....                       &lt;chr&gt; &quot;36,0&quot;, &quot;86,5&quot;, &quot;70,0&quot;, &quot;97,0&quot;, &quot;10~
## $ Phones..per.1000.                  &lt;chr&gt; &quot;3,2&quot;, &quot;71,2&quot;, &quot;78,1&quot;, &quot;259,5&quot;, &quot;49~
## $ Arable....                         &lt;chr&gt; &quot;12,13&quot;, &quot;21,09&quot;, &quot;3,22&quot;, &quot;10&quot;, &quot;2,~
## $ Crops....                          &lt;chr&gt; &quot;0,22&quot;, &quot;4,42&quot;, &quot;0,25&quot;, &quot;15&quot;, &quot;0&quot;, ~
## $ Other....                          &lt;chr&gt; &quot;87,65&quot;, &quot;74,49&quot;, &quot;96,53&quot;, &quot;75&quot;, &quot;9~
## $ Climate                            &lt;chr&gt; &quot;1&quot;, &quot;3&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;&quot;, &quot;2&quot;, &quot;~
## $ Birthrate                          &lt;chr&gt; &quot;46,6&quot;, &quot;15,11&quot;, &quot;17,14&quot;, &quot;22,46&quot;, ~
## $ Deathrate                          &lt;chr&gt; &quot;20,34&quot;, &quot;5,22&quot;, &quot;4,61&quot;, &quot;3,27&quot;, &quot;6~
## $ Agriculture                        &lt;chr&gt; &quot;0,38&quot;, &quot;0,232&quot;, &quot;0,101&quot;, &quot;&quot;, &quot;&quot;, &quot;~
## $ Industry                           &lt;chr&gt; &quot;0,24&quot;, &quot;0,188&quot;, &quot;0,6&quot;, &quot;&quot;, &quot;&quot;, &quot;0,~
## $ Service                            &lt;chr&gt; &quot;0,38&quot;, &quot;0,579&quot;, &quot;0,298&quot;, &quot;&quot;, &quot;&quot;, &quot;~</code></pre>
<pre class="r"><code>glimpse(vaccinations)</code></pre>
<pre><code>## Rows: 5,689
## Columns: 15
## $ country                             &lt;chr&gt; &quot;Albania&quot;, &quot;Albania&quot;, &quot;Albania&quot;, &quot;~
## $ iso_code                            &lt;chr&gt; &quot;ALB&quot;, &quot;ALB&quot;, &quot;ALB&quot;, &quot;ALB&quot;, &quot;ALB&quot;,~
## $ date                                &lt;chr&gt; &quot;2021-01-10&quot;, &quot;2021-01-11&quot;, &quot;2021-~
## $ total_vaccinations                  &lt;dbl&gt; 0, NA, 128, 188, 266, 308, 369, 40~
## $ people_vaccinated                   &lt;dbl&gt; 0, NA, 128, 188, 266, 308, 369, 40~
## $ people_fully_vaccinated             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA~
## $ daily_vaccinations_raw              &lt;dbl&gt; NA, NA, NA, 60, 78, 42, 61, 36, 42~
## $ daily_vaccinations                  &lt;dbl&gt; NA, 64, 64, 63, 66, 62, 62, 58, 55~
## $ total_vaccinations_per_hundred      &lt;dbl&gt; 0.00, NA, 0.00, 0.01, 0.01, 0.01, ~
## $ people_vaccinated_per_hundred       &lt;dbl&gt; 0.00, NA, 0.00, 0.01, 0.01, 0.01, ~
## $ people_fully_vaccinated_per_hundred &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA~
## $ daily_vaccinations_per_million      &lt;dbl&gt; NA, 22, 22, 22, 23, 22, 22, 20, 19~
## $ vaccines                            &lt;chr&gt; &quot;Pfizer/BioNTech&quot;, &quot;Pfizer/BioNTec~
## $ source_name                         &lt;chr&gt; &quot;Ministry of Health&quot;, &quot;Ministry of~
## $ source_website                      &lt;chr&gt; &quot;https://shendetesia.gov.al/covid1~</code></pre>
<pre class="r"><code># Fix formatting of country name strings
countries$Country &lt;- str_squish(countries$Country)
countries$Region &lt;- str_squish(countries$Region)</code></pre>
<p><em>Fixed formatting of country name strings to remove any leading or trailing whitespace that would interfere with joining</em></p>
<pre class="r"><code>#remove days during which no new vaccination data was collected 
vaccinations &lt;- vaccinations[complete.cases(vaccinations[,4]), ]
vaccinations$date &lt;- as.Date(vaccinations$date)</code></pre>
<p><em>Removed days during which no new vaccination data was collected. Also converted date strings to date objects in the vaccinations dataframe</em></p>
<pre class="r"><code>#change countries dataframe column names to something more manageable
dfc_names = c(&quot;Country&quot;, &quot;Region&quot;, &quot;Population&quot;, &quot;area_sq_mi&quot;, &quot;pop_density&quot;, &quot;coastline&quot;, &quot;net_migration&quot;, &quot;infant_mortality&quot;, &quot;GDP_per_capita&quot;, &quot;literacy&quot;, &quot;phones&quot;, &quot;arable_land&quot;, &quot;crops&quot;, &quot;other&quot;, &quot;climate&quot;, &quot;birthrate&quot;, &quot;deathrate&quot;, &quot;agriculture&quot;, &quot;industry&quot;, &quot;service&quot;)

names(countries) = dfc_names
names(vaccinations)[1] = &quot;Country&quot;</code></pre>
<p><em>Change column titles of countries dataframe to make them more palatable</em></p>
<pre class="r"><code>#convert strings in form x,xx to numeric values with the form x.xx
for(i in 5:20) {
  countries[,i] &lt;- as.numeric(gsub(&quot;,&quot;,&quot;.&quot;, gsub(&quot;\\.&quot;, &quot;&quot;, countries[,i])))
}</code></pre>
<p><em>Convert strings in form x,xx to numeric values with the form x.xx</em></p>
</div>
<div id="joining" class="section level2">
<h2>Joining</h2>
<pre class="r"><code>#Left join our two datasets to create a dataframe consisting of covid vaccine information as well as country demographic information

covid_data &lt;- left_join(vaccinations, countries, by = &quot;Country&quot;)

#Mutate to create pct_vaccinated variable. This variable represents the percentage of the total population that has been vaccinated

covid_data &lt;- covid_data %&gt;% mutate(pct_vaccinated = 100*(people_vaccinated/Population), na.rm = T)

glimpse(covid_data)</code></pre>
<pre><code>## Rows: 3,634
## Columns: 36
## $ Country                             &lt;chr&gt; &quot;Albania&quot;, &quot;Albania&quot;, &quot;Albania&quot;, &quot;~
## $ iso_code                            &lt;chr&gt; &quot;ALB&quot;, &quot;ALB&quot;, &quot;ALB&quot;, &quot;ALB&quot;, &quot;ALB&quot;,~
## $ date                                &lt;date&gt; 2021-01-10, 2021-01-12, 2021-01-1~
## $ total_vaccinations                  &lt;dbl&gt; 0, 128, 188, 266, 308, 369, 405, 4~
## $ people_vaccinated                   &lt;dbl&gt; 0, 128, 188, 266, 308, 369, 405, 4~
## $ people_fully_vaccinated             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA~
## $ daily_vaccinations_raw              &lt;dbl&gt; NA, NA, 60, 78, 42, 61, 36, 42, 36~
## $ daily_vaccinations                  &lt;dbl&gt; NA, 64, 63, 66, 62, 62, 58, 55, 51~
## $ total_vaccinations_per_hundred      &lt;dbl&gt; 0.00, 0.00, 0.01, 0.01, 0.01, 0.01~
## $ people_vaccinated_per_hundred       &lt;dbl&gt; 0.00, 0.00, 0.01, 0.01, 0.01, 0.01~
## $ people_fully_vaccinated_per_hundred &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA~
## $ daily_vaccinations_per_million      &lt;dbl&gt; NA, 22, 22, 23, 22, 22, 20, 19, 18~
## $ vaccines                            &lt;chr&gt; &quot;Pfizer/BioNTech&quot;, &quot;Pfizer/BioNTec~
## $ source_name                         &lt;chr&gt; &quot;Ministry of Health&quot;, &quot;Ministry of~
## $ source_website                      &lt;chr&gt; &quot;https://shendetesia.gov.al/covid1~
## $ Region                              &lt;chr&gt; &quot;EASTERN EUROPE&quot;, &quot;EASTERN EUROPE&quot;~
## $ Population                          &lt;int&gt; 3581655, 3581655, 3581655, 3581655~
## $ area_sq_mi                          &lt;int&gt; 28748, 28748, 28748, 28748, 28748,~
## $ pop_density                         &lt;dbl&gt; 124.6, 124.6, 124.6, 124.6, 124.6,~
## $ coastline                           &lt;dbl&gt; 1.26, 1.26, 1.26, 1.26, 1.26, 1.26~
## $ net_migration                       &lt;dbl&gt; -4.93, -4.93, -4.93, -4.93, -4.93,~
## $ infant_mortality                    &lt;dbl&gt; 21.52, 21.52, 21.52, 21.52, 21.52,~
## $ GDP_per_capita                      &lt;dbl&gt; 4500, 4500, 4500, 4500, 4500, 4500~
## $ literacy                            &lt;dbl&gt; 86.5, 86.5, 86.5, 86.5, 86.5, 86.5~
## $ phones                              &lt;dbl&gt; 71.2, 71.2, 71.2, 71.2, 71.2, 71.2~
## $ arable_land                         &lt;dbl&gt; 21.09, 21.09, 21.09, 21.09, 21.09,~
## $ crops                               &lt;dbl&gt; 4.42, 4.42, 4.42, 4.42, 4.42, 4.42~
## $ other                               &lt;dbl&gt; 74.49, 74.49, 74.49, 74.49, 74.49,~
## $ climate                             &lt;dbl&gt; 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3~
## $ birthrate                           &lt;dbl&gt; 15.11, 15.11, 15.11, 15.11, 15.11,~
## $ deathrate                           &lt;dbl&gt; 5.22, 5.22, 5.22, 5.22, 5.22, 5.22~
## $ agriculture                         &lt;dbl&gt; 0.232, 0.232, 0.232, 0.232, 0.232,~
## $ industry                            &lt;dbl&gt; 0.188, 0.188, 0.188, 0.188, 0.188,~
## $ service                             &lt;dbl&gt; 0.579, 0.579, 0.579, 0.579, 0.579,~
## $ pct_vaccinated                      &lt;dbl&gt; 0.000000000, 0.003573767, 0.005248~
## $ na.rm                               &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE~</code></pre>
<p><em>Here, I chose to perform a left_join with vaccinations being the ‘left’ dataframe and countries being the ‘right’ dataframe. I chose this join primarily because for what I wish to inspect, the vaccination data is of more importance. Furthermore, since the vaccinations dataframe has multiple entries for each country (because entries are facetted by date) there is a much lower chance of loss of data with the countries dataframe than the vaccinations dataframe. The way I thought about it is I was tacking on country demographics for each country’s daily vaccination entry.</em></p>
</div>
<div id="dataset-inspection" class="section level2">
<h2>Dataset Inspection</h2>
<pre class="r"><code>#total number of people vaccinated per country, per day
Daily_vaccinations &lt;- covid_data %&gt;% select(c(&quot;Country&quot;, &quot;date&quot;, &quot;daily_vaccinations&quot;)) %&gt;% pivot_wider(., names_from = &quot;Country&quot;, values_from = daily_vaccinations)
head(Daily_vaccinations,5)</code></pre>
<pre><code>## # A tibble: 5 x 130
##   date       Albania Algeria Andorra Anguilla Argentina Australia Austria
##   &lt;date&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 2021-01-10      NA      NA      NA       NA        NA        NA    3547
## 2 2021-01-12      64      NA      NA       NA        NA        NA    6110
## 3 2021-01-13      63      NA      NA       NA     13323        NA    8084
## 4 2021-01-14      66      NA      NA       NA        NA        NA    9885
## 5 2021-01-15      62      NA      NA       NA     13317        NA   10540
## # ... with 122 more variables: Azerbaijan &lt;dbl&gt;, Bahrain &lt;dbl&gt;,
## #   Bangladesh &lt;dbl&gt;, Barbados &lt;dbl&gt;, Belarus &lt;dbl&gt;, Belgium &lt;dbl&gt;,
## #   Belize &lt;dbl&gt;, Bermuda &lt;dbl&gt;, Bolivia &lt;dbl&gt;, Brazil &lt;dbl&gt;, Bulgaria &lt;dbl&gt;,
## #   Cambodia &lt;dbl&gt;, Canada &lt;dbl&gt;, Cayman Islands &lt;dbl&gt;, Chile &lt;dbl&gt;,
## #   China &lt;dbl&gt;, Colombia &lt;dbl&gt;, Costa Rica &lt;dbl&gt;, Croatia &lt;dbl&gt;, Cyprus &lt;dbl&gt;,
## #   Czechia &lt;dbl&gt;, Denmark &lt;dbl&gt;, Dominica &lt;dbl&gt;, Dominican Republic &lt;dbl&gt;,
## #   Ecuador &lt;dbl&gt;, Egypt &lt;dbl&gt;, El Salvador &lt;dbl&gt;, England &lt;dbl&gt;,
## #   Estonia &lt;dbl&gt;, Faeroe Islands &lt;dbl&gt;, Falkland Islands &lt;dbl&gt;, Finland &lt;dbl&gt;,
## #   France &lt;dbl&gt;, Germany &lt;dbl&gt;, Gibraltar &lt;dbl&gt;, Greece &lt;dbl&gt;,
## #   Greenland &lt;dbl&gt;, Grenada &lt;dbl&gt;, Guatemala &lt;dbl&gt;, Guernsey &lt;dbl&gt;,
## #   Guyana &lt;dbl&gt;, Honduras &lt;dbl&gt;, Hong Kong &lt;dbl&gt;, Hungary &lt;dbl&gt;,
## #   Iceland &lt;dbl&gt;, India &lt;dbl&gt;, Indonesia &lt;dbl&gt;, Iran &lt;dbl&gt;, Ireland &lt;dbl&gt;,
## #   Isle of Man &lt;dbl&gt;, Israel &lt;dbl&gt;, Italy &lt;dbl&gt;, Japan &lt;dbl&gt;, Jersey &lt;dbl&gt;,
## #   Jordan &lt;dbl&gt;, Kazakhstan &lt;dbl&gt;, Kuwait &lt;dbl&gt;, Latvia &lt;dbl&gt;, Lebanon &lt;dbl&gt;,
## #   Liechtenstein &lt;dbl&gt;, Lithuania &lt;dbl&gt;, Luxembourg &lt;dbl&gt;, Macao &lt;dbl&gt;,
## #   Malaysia &lt;dbl&gt;, Maldives &lt;dbl&gt;, Malta &lt;dbl&gt;, Mauritius &lt;dbl&gt;, Mexico &lt;dbl&gt;,
## #   Moldova &lt;dbl&gt;, Monaco &lt;dbl&gt;, Mongolia &lt;dbl&gt;, Montenegro &lt;dbl&gt;,
## #   Montserrat &lt;dbl&gt;, Morocco &lt;dbl&gt;, Myanmar &lt;dbl&gt;, Nepal &lt;dbl&gt;,
## #   Netherlands &lt;dbl&gt;, New Zealand &lt;dbl&gt;, Northern Cyprus &lt;dbl&gt;,
## #   Northern Ireland &lt;dbl&gt;, Norway &lt;dbl&gt;, Oman &lt;dbl&gt;, Pakistan &lt;dbl&gt;,
## #   Panama &lt;dbl&gt;, Paraguay &lt;dbl&gt;, Peru &lt;dbl&gt;, Philippines &lt;dbl&gt;, Poland &lt;dbl&gt;,
## #   Portugal &lt;dbl&gt;, Qatar &lt;dbl&gt;, Romania &lt;dbl&gt;, Russia &lt;dbl&gt;, Rwanda &lt;dbl&gt;,
## #   Saint Helena &lt;dbl&gt;, Saint Lucia &lt;dbl&gt;, San Marino &lt;dbl&gt;,
## #   Saudi Arabia &lt;dbl&gt;, Scotland &lt;dbl&gt;, Senegal &lt;dbl&gt;, Serbia &lt;dbl&gt;, ...</code></pre>
<p><em>Pivoting wider produces a strange version of the dataset in which columns are countries and rows are dates.</em></p>
<pre class="r"><code>#Easily inspect the temporal vaccination response of each country with one line of code
Daily_vaccinations[,c(&quot;date&quot;,&quot;United States&quot;)]</code></pre>
<pre><code>## # A tibble: 87 x 2
##    date       `United States`
##    &lt;date&gt;               &lt;dbl&gt;
##  1 2021-01-10              NA
##  2 2021-01-12          641524
##  3 2021-01-13          710238
##  4 2021-01-14          747082
##  5 2021-01-15          798707
##  6 2021-01-16              NA
##  7 2021-01-17              NA
##  8 2021-01-18              NA
##  9 2021-01-19          911493
## 10 2021-01-20          892403
## # ... with 77 more rows</code></pre>
<p><em>This line of code allows for easy inspection of the temporal daily vaccination response of any country. I included this specific manipulation initially as a means of displaying my use of pivot_wider, but, after further inspection I found it be very useful and easy to explore. </em></p>
<pre class="r"><code>#average vaccinations taking place per day, per country
Daily_vaccinations %&gt;% summarise_all(list(mean = mean, sd = sd), na.rm=T) %&gt;% .[,-1] %&gt;% pivot_longer(contains(&quot;_&quot;)) %&gt;% separate(name, sep = &quot;_&quot;, into = c(&quot;Country&quot;, &quot;Statistic&quot;)) %&gt;% pivot_wider(., names_from = Statistic, values_from = value) %&gt;% arrange(Country)</code></pre>
<pre><code>## # A tibble: 130 x 3
##    Country       mean      sd
##    &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;
##  1 Albania       288    381. 
##  2 Algeria      1889   2629. 
##  3 Andorra        58     16.3
##  4 Anguilla      192.   123. 
##  5 Argentina   23403. 19080. 
##  6 Australia    4669   2526. 
##  7 Austria     11142.  6280. 
##  8 Azerbaijan  10072.  4861. 
##  9 Bahrain      3748.  2553. 
## 10 Bangladesh 112385. 62601. 
## # ... with 120 more rows</code></pre>
<p><em>This manipulation creates summary statistics (mean and standard deviation) of the raw daily vaccinations occurring in each country.</em></p>
<pre class="r"><code>covid_data %&gt;% filter(date == as.Date(&quot;2021-03-01&quot;)) %&gt;% select(Country, Region, where(is.numeric)) %&gt;% group_by(Region) %&gt;% summarise_if(is.numeric, list(cheesemean = mean, cheesesd = sd, cheesemin = min, cheesemax = max), na.rm = T) %&gt;% pivot_longer(contains(&quot;cheese&quot;)) %&gt;% separate(name, sep=&quot;cheese&quot;, into = c(&quot;variable&quot;,&quot;statistic&quot;)) %&gt;% pivot_wider(., names_from = statistic, values_from = value) %&gt;% arrange(Region) -&gt; summary_stats

glimpse(summary_stats)</code></pre>
<pre><code>## Rows: 336
## Columns: 6
## $ Region   &lt;chr&gt; &quot;ASIA (EX. NEAR EAST)&quot;, &quot;ASIA (EX. NEAR EAST)&quot;, &quot;ASIA (EX. NE~
## $ variable &lt;chr&gt; &quot;total_vaccinations_&quot;, &quot;people_vaccinated_&quot;, &quot;people_fully_va~
## $ mean     &lt;dbl&gt; 1.895276e+06, 2.065537e+06, 1.289099e+06, 1.513682e+05, 6.619~
## $ sd       &lt;dbl&gt; 4.634814e+06, 4.538942e+06, 1.211286e+06, 2.318589e+05, 1.529~
## $ min      &lt;dbl&gt; 319.000, 24331.000, 207324.000, 5700.000, 160.000, 0.000, 0.0~
## $ max      &lt;dbl&gt; 1.485414e+07, 1.225634e+07, 2.597799e+06, 5.528700e+05, 4.900~</code></pre>
<p><em>This manipulation goes 10 steps further and creates summary statistics (mean, standard deviation, min, max) for all numeric data in the Covid dataset, grouped by geographical region.</em></p>
<pre class="r"><code>summary_stats %&gt;% filter(variable == &quot;total_vaccinations_&quot;)</code></pre>
<pre><code>## # A tibble: 12 x 6
##    Region               variable                 mean        sd     min      max
##    &lt;chr&gt;                &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1 ASIA (EX. NEAR EAST) total_vaccinations_  1895276.  4634814.     319 14854136
##  2 BALTICS              total_vaccinations_   141219.    94107.   64590   246257
##  3 C.W. OF IND. STATES  total_vaccinations_  1845744.  2942154.    4905  5238966
##  4 EASTERN EUROPE       total_vaccinations_   942611.  1081295.   14295  3383426
##  5 LATIN AMER. &amp; CARIB  total_vaccinations_  1241368.  2440281.    2427  8465403
##  6 NEAR EAST            total_vaccinations_  5769942   3996511.   45859  8774718
##  7 NORTHERN AFRICA      total_vaccinations_  3801650        NA  3801650  3801650
##  8 NORTHERN AMERICA     total_vaccinations_ 19717875. 38132304.    3927 76899987
##  9 OCEANIA              total_vaccinations_    33702        NA    33702    33702
## 10 SUB-SAHARAN AFRICA   total_vaccinations_    45629.    30671.   21456    80131
## 11 WESTERN EUROPE       total_vaccinations_  2482309.  4947314.     275 21322717
## 12 &lt;NA&gt;                 total_vaccinations_  3667608.  7037406.    1531 17985951</code></pre>
<p><em>Here is how one would navigate this summary_stats dataframe.</em></p>
<pre class="r"><code>covid_data %&gt;% filter(date == as.Date(&quot;2021-03-01&quot;)) %&gt;% filter(Region != is.na(.)) %&gt;% ggplot(aes(Region, fill=Region)) + geom_bar(aes(y=pct_vaccinated), stat = &quot;summary&quot;, fun = mean, na.rm = T)+ theme(legend.position = &quot;none&quot;, axis.text.x = element_text(angle = 45, hjust = 1)) + labs(title = &quot;Average Percentage of Population Vaccinated&quot;, subtitle = &quot;Faceted by Geographic Region&quot;) + ylab(&quot;Mean % Vaccinated&quot;)</code></pre>
<p><img src="/project/project1_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><em>This plot visualizes the state of covid vaccinations in each region as of March 1st. The plot does this by filtering the data down to just March 1st entries then performing a nested stat=“summary” in a geom_bar object. The final result is the bar plot seen above where each category is a geographical region of the world and the corresponding y value is the average percentage of the population vaccinated for countries within those respective regions. This plot was very interesting to me because it shows us trends which are somewhat counter-intuitive. For Starters, as you can see the near east is doing particularly well with their vaccinations, sitting at an average of ~43% vaccinated. This value is driven heavily by Israel who as of March 1st had ~75% of their population vaccinated which is one of the best vaccination percentages of any country. This, coupled with the fact that other Middle East countries have large gaps in their Covid data (or just no data all together), lead to this drastically exaggerated bar. A similar phenomena occurs with the sub-saharan africa bin. While a majority of sub-saharan african countries were sitting below 1% vaccinated as of March 1st, the country of Seyechelles had vaccinated ~70% of their 98k person population, thus drastically skewing this bar.</em></p>
<pre class="r"><code>#data faceted by vaccine type

covid_data %&gt;% filter(date == as.Date(&quot;2021-03-01&quot;)) %&gt;% select(Country, vaccines, where(is.numeric)) %&gt;% separate_rows(vaccines,sep = &quot;,&quot;) %&gt;% group_by(vaccines) -&gt; vaccine_data

vaccine_data$vaccines &lt;- str_squish(vaccine_data$vaccines)</code></pre>
<p><em>Moving on, I now wanted to explore my data as a function of the vaccine type. In order to do this I needed to manipulate my master covid_data dateset into a dataframe facetted by vaccine. The issue with this arose when I realized that the vaccine column of my covid_data dataframe included all vaccines used by a country in list form, separated with commas. In order to fix this and reshape the dataset to include an entry for each vaccine used by a certain country, I had to utilize the separate_rows() function as well as our old friend str_squish().</em></p>
<pre class="r"><code>vaccine_data %&gt;% summarise(mean_pct_vaccinated = mean(pct_vaccinated, na.rm=T), mean_gdp = mean(GDP_per_capita, na.rm=T), mean_literacy = mean(literacy, na.rm=T)) %&gt;% .[complete.cases(.),] -&gt; vaccine_data_summarized

vaccine_data_summarized</code></pre>
<pre><code>## # A tibble: 9 x 4
##   vaccines           mean_pct_vaccinated mean_gdp mean_literacy
##   &lt;chr&gt;                            &lt;dbl&gt;    &lt;dbl&gt;         &lt;dbl&gt;
## 1 Covaxin                           1.12    2900           59.5
## 2 EpiVacCorona                      2.90    8900           99.6
## 3 Johnson&amp;Johnson                  17.0    37800           97  
## 4 Moderna                           8.59   23485.          97.4
## 5 Oxford/AstraZeneca                8.47   17713.          93.5
## 6 Pfizer/BioNTech                   8.28   20190.          96.3
## 7 Sinopharm/Beijing                12.4     7522.          75.3
## 8 Sinovac                           5.05    9567.          92.3
## 9 Sputnik V                         4.14   14714.          93.6</code></pre>
<p><em>Starting with our large vaccine_data dataframe, which includes all numeric columns from the original dataframe, I filtered down the data such that the two most important (in my non-anthropoligist opinion) demographic indicators were left as well as the percentage of the population vaccinated. After this, I grouped by vaccine and using summarise(), computed average values for these demographic indicators. The indicators I chose were GDP per capita and literacy rate because I felt that of all the demographic statistics that could define the affluence of a country, those two were the best. The reason I have limited myself to three variables is because I wish to represent the differences in the vaccines’ target demographics in 3d space</em></p>
<pre class="r"><code>library(plotly)

plot_ly(x = vaccine_data_summarized$mean_pct_vaccinated, y= vaccine_data_summarized$mean_gdp, z= vaccine_data_summarized$mean_literacy, type = &quot;scatter3d&quot;, mode = &quot;markers&quot;, color = vaccine_data_summarized$vaccines) %&gt;% layout(title = &quot;Covid Vaccines and their Distribution&quot;, scene = list(xaxis = list(title = &quot;pct vaccinated&quot;), yaxis = list(title = &quot;GDP&quot;), zaxis = list(title = &quot;Literacy rate&quot;)))</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"48d45e034627":["function () ","plotlyVisDat"]},"cur_data":"48d45e034627","attrs":{"48d45e034627":{"x":[1.1189404918188,2.89749417643373,16.9991557718752,8.58757690179319,8.46624338986753,8.27534080456797,12.3912636613707,5.05337899939091,4.14249343021242],"y":[2900,8900,37800,23484.6153846154,17713.1578947368,20189.5833333333,7522.22222222222,9566.66666666667,14714.2857142857],"z":[59.5,99.6,97,97.4461538461538,93.5432432432432,96.2555555555556,75.2666666666667,92.2888888888889,93.6],"mode":"markers","color":["Covaxin","EpiVacCorona","Johnson&Johnson","Moderna","Oxford/AstraZeneca","Pfizer/BioNTech","Sinopharm/Beijing","Sinovac","Sputnik V"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Covid Vaccines and their Distribution","scene":{"xaxis":{"title":"pct vaccinated"},"yaxis":{"title":"GDP"},"zaxis":{"title":"Literacy rate"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[1.1189404918188],"y":[2900],"z":[59.5],"mode":"markers","type":"scatter3d","name":"Covaxin","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"frame":null},{"x":[2.89749417643373],"y":[8900],"z":[99.6],"mode":"markers","type":"scatter3d","name":"EpiVacCorona","marker":{"color":"rgba(239,150,106,1)","line":{"color":"rgba(239,150,106,1)"}},"textfont":{"color":"rgba(239,150,106,1)"},"error_y":{"color":"rgba(239,150,106,1)"},"error_x":{"color":"rgba(239,150,106,1)"},"line":{"color":"rgba(239,150,106,1)"},"frame":null},{"x":[16.9991557718752],"y":[37800],"z":[97],"mode":"markers","type":"scatter3d","name":"Johnson&Johnson","marker":{"color":"rgba(178,156,177,1)","line":{"color":"rgba(178,156,177,1)"}},"textfont":{"color":"rgba(178,156,177,1)"},"error_y":{"color":"rgba(178,156,177,1)"},"error_x":{"color":"rgba(178,156,177,1)"},"line":{"color":"rgba(178,156,177,1)"},"frame":null},{"x":[8.58757690179319],"y":[23484.6153846154],"z":[97.4461538461538],"mode":"markers","type":"scatter3d","name":"Moderna","marker":{"color":"rgba(201,148,198,1)","line":{"color":"rgba(201,148,198,1)"}},"textfont":{"color":"rgba(201,148,198,1)"},"error_y":{"color":"rgba(201,148,198,1)"},"error_x":{"color":"rgba(201,148,198,1)"},"line":{"color":"rgba(201,148,198,1)"},"frame":null},{"x":[8.46624338986753],"y":[17713.1578947368],"z":[93.5432432432432],"mode":"markers","type":"scatter3d","name":"Oxford/AstraZeneca","marker":{"color":"rgba(205,180,144,1)","line":{"color":"rgba(205,180,144,1)"}},"textfont":{"color":"rgba(205,180,144,1)"},"error_y":{"color":"rgba(205,180,144,1)"},"error_x":{"color":"rgba(205,180,144,1)"},"line":{"color":"rgba(205,180,144,1)"},"frame":null},{"x":[8.27534080456797],"y":[20189.5833333333],"z":[96.2555555555556],"mode":"markers","type":"scatter3d","name":"Pfizer/BioNTech","marker":{"color":"rgba(202,217,72,1)","line":{"color":"rgba(202,217,72,1)"}},"textfont":{"color":"rgba(202,217,72,1)"},"error_y":{"color":"rgba(202,217,72,1)"},"error_x":{"color":"rgba(202,217,72,1)"},"line":{"color":"rgba(202,217,72,1)"},"frame":null},{"x":[12.3912636613707],"y":[7522.22222222222],"z":[75.2666666666667],"mode":"markers","type":"scatter3d","name":"Sinopharm/Beijing","marker":{"color":"rgba(250,212,80,1)","line":{"color":"rgba(250,212,80,1)"}},"textfont":{"color":"rgba(250,212,80,1)"},"error_y":{"color":"rgba(250,212,80,1)"},"error_x":{"color":"rgba(250,212,80,1)"},"line":{"color":"rgba(250,212,80,1)"},"frame":null},{"x":[5.05337899939091],"y":[9566.66666666667],"z":[92.2888888888889],"mode":"markers","type":"scatter3d","name":"Sinovac","marker":{"color":"rgba(223,194,152,1)","line":{"color":"rgba(223,194,152,1)"}},"textfont":{"color":"rgba(223,194,152,1)"},"error_y":{"color":"rgba(223,194,152,1)"},"error_x":{"color":"rgba(223,194,152,1)"},"line":{"color":"rgba(223,194,152,1)"},"frame":null},{"x":[4.14249343021242],"y":[14714.2857142857],"z":[93.6],"mode":"markers","type":"scatter3d","name":"Sputnik V","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"line":{"color":"rgba(179,179,179,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><em>Above is the aforementioned plot of the vaccines as a function of demographic indicators. From this plot we may infer several conclusions about the vaccines and their target demographics. For starters, we may observe that the Covaxin vaccine is targeted towards poorer, more developing countries as it is low on all three variables. In opposition, the Johnson &amp; Johnson vaccine sits in the opposite corner of the plot with the highest average GDP, Literacy rate, and percentage vaccinated. The reason for this outlier is simple, the Johnson &amp; Johnson vaccine, as of March 1st, was only available in the United States. Ignoring this outlier, we can see that of the more widespread vaccines, the Moderna vaccine serves, on average, the most affluent nations.</em></p>
</div>
<div id="correlation-heatmap" class="section level2">
<h2>Correlation Heatmap</h2>
<pre class="r"><code>#correlation heatmap
library(reshape2)

temp_data &lt;- covid_data %&gt;% filter(date == as.Date(&quot;2021-03-01&quot;)) %&gt;% .[complete.cases(.),] %&gt;% select(c(4,12,17,19,21,22,23,24,30,31,32,33,34,35))</code></pre>
<p><em>Now, it is time to make our correlation heatmap. To do this, I filtered my dataset down again to only March 1st entries. I then painstakingly went through my dataset and maually picked the demographic and Covid variables that I felt would be best represented by the correlation heatmap. I did this because certain columns such as coastline (proportion of border that is coast) aren’t of immediate importance to my analysis. Furthermore, since my dataset has so many numeric variables I didn’t want my heatmap and its axes to be too cluttered.</em></p>
<pre class="r"><code>cormat &lt;- round(cor(temp_data),2)
head(cormat)</code></pre>
<pre><code>##                                total_vaccinations
## total_vaccinations                           1.00
## daily_vaccinations_per_million               0.34
## Population                                   0.35
## pop_density                                  0.00
## net_migration                                0.23
## infant_mortality                             0.03
##                                daily_vaccinations_per_million Population
## total_vaccinations                                       0.34       0.35
## daily_vaccinations_per_million                           1.00      -0.22
## Population                                              -0.22       1.00
## pop_density                                              0.26       0.37
## net_migration                                            0.25      -0.08
## infant_mortality                                        -0.35       0.71
##                                pop_density net_migration infant_mortality
## total_vaccinations                    0.00          0.23             0.03
## daily_vaccinations_per_million        0.26          0.25            -0.35
## Population                            0.37         -0.08             0.71
## pop_density                           1.00          0.16             0.13
## net_migration                         0.16          1.00            -0.42
## infant_mortality                      0.13         -0.42             1.00
##                                GDP_per_capita literacy birthrate deathrate
## total_vaccinations                       0.27    -0.12      0.17     -0.16
## daily_vaccinations_per_million           0.30     0.24     -0.01     -0.11
## Population                              -0.31    -0.91      0.59     -0.22
## pop_density                              0.06    -0.34      0.08      0.02
## net_migration                            0.69     0.17     -0.26     -0.05
## infant_mortality                        -0.75    -0.85      0.69     -0.31
##                                agriculture industry service pct_vaccinated
## total_vaccinations                   -0.11    -0.35    0.32           0.22
## daily_vaccinations_per_million       -0.40    -0.12    0.28           0.94
## Population                            0.63    -0.10   -0.20          -0.14
## pop_density                           0.01    -0.33    0.24           0.38
## net_migration                        -0.36     0.07    0.11           0.15
## infant_mortality                      0.92     0.16   -0.53          -0.23</code></pre>
<pre class="r"><code>melted_cormat &lt;- melt(cormat)
melted_cormat %&gt;% ggplot(aes(Var1, Var2, fill=value)) + geom_tile() + theme(axis.text.x = element_text(angle = 55, hjust = 1)) + scale_fill_gradient2(low= &quot;red&quot;, high = &quot;blue&quot;)</code></pre>
<p><img src="/project/project1_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><em>Here is the resulting correlation heatmap. In order to limit myself from writing a novel on this plot, I will focus only on the most interesting relationships I’ve observed. The first thing that stood out to me was literacy rate and GDP per capita’s nearly identical strong inverse correlations with the rest of the variables. These kind of relationships show the power of these two variables and are the reason why I chose to represent the vaccines as functions of these variables in the previous plot. Moving on, another trend that stood out to me was that the percentage of a country’s population that is vaccinated is not strongly correlated with really anything, aside from daily vaccinations per million obviously. This result was highly unexpected to be honest. I expected that at the very least percent vaccinated would be somewhat correlated with literacy, gdp, and infant_mortality but that simply isn’t the case. I think what I’ve learned from this is that the worldwide vaccine roll-out is not nearly as well defined as we would like. The same trends that always seem to hold true are breaking down as a result of this unprecedented situation.</em></p>
</div>
<div id="k-means-clustering" class="section level2">
<h2>K Means Clustering</h2>
<pre class="r"><code># k-means clustering
covid_data %&gt;% filter(date == as.Date(&quot;2021-03-01&quot;)) %&gt;% select(GDP_per_capita, literacy, infant_mortality) %&gt;% .[complete.cases(.), ] %&gt;% kmeans(4) -&gt; kmeans1</code></pre>
<p><em>Here I performed my K-means clustering on the Demographic variables GDP per capita, literacy rate, and infant mortality. I chose to perform my clustering on these variables because, according to my correlation heatmap above, they have the strongest correlations with the rest of the dataset. Furthermore, my goal of this clustering is to divide the nations of the world into 4 different groups representing different stages of development and in order to do so, these demographic variables are of the most importance.</em></p>
<pre class="r"><code>library(plotly)

covid_data %&gt;% filter(date == as.Date(&quot;2021-03-01&quot;))%&gt;% select(Country, Region, Population, GDP_per_capita, literacy, infant_mortality) %&gt;% .[complete.cases(.), ] %&gt;% mutate(cluster = as.factor(kmeans1$cluster)) -&gt; kmeans2

plot_ly(kmeans2, x= ~GDP_per_capita, y= ~literacy, z= ~infant_mortality, type=&quot;scatter3d&quot;, mode=&quot;markers&quot;, color= ~cluster) -&gt; kmeans_plot

kmeans_plot &lt;- kmeans_plot %&gt;% layout(title = &quot;k means clustering of Country Demographics&quot;)

kmeans_plot</code></pre>
<div id="htmlwidget-2" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"visdat":{"48d477583315":["function () ","plotlyVisDat"]},"cur_data":"48d477583315","attrs":{"48d477583315":{"x":{},"y":{},"z":{},"mode":"markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"k means clustering of Country Demographics","scene":{"xaxis":{"title":"GDP_per_capita"},"yaxis":{"title":"literacy"},"zaxis":{"title":"infant_mortality"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[29000,30000,29100,36000,29800,31100,27400,27600,27600,28800,30900,29600,26700,28200,55100,37800,34600,32700,27700,37800],"y":[100,98,98,98,97,100,100,99,99,93.5,99.9,98,98.6,99,100,100,96,99,99,97],"z":[4.69,4.66,4.68,8.53,4.75,4.56,3.57,4.26,4.16,2.97,3.31,5.39,5.94,3.26,4.81,3.7,5.73,4.39,5.16,6.5],"mode":"markers","type":"scatter3d","name":"1","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"frame":null},{"x":[4500,3400,1900,6300,5400,6000,3300,4100,2900,3200,4800,3900,4000,6300,7000,1600,2200,3700,6700,5400,1900],"y":[86.5,97,69.4,92.5,94,84.7,92.5,70.6,59.5,87.9,87.4,97.2,51.7,92.6,98.4,40.2,93,92.3,86.5,99.7,90.7],"z":[21.52,81.74,71.48,20.97,14.15,32.38,23.66,35.93,56.29,35.6,24.52,56.52,41.62,20.47,26.43,55.51,12.89,14.35,41.04,20.34,67.69],"mode":"markers","type":"scatter3d","name":"2","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"frame":null},{"x":[11200,7600,7600,9900,9100,10600,12300,13900,10200,11400,9000,9000,11100,8900,7800,7400,12800],"y":[97.1,86.4,98.6,96.2,96,98.5,99.8,99.4,99.8,99.6,88.7,92.2,99.8,99.6,58,92.6,98],"z":[15.18,29.61,20.55,8.8,9.95,6.84,7.87,8.57,9.55,6.89,17.7,20.91,8.51,15.39,15.53,20.48,11.95],"mode":"markers","type":"scatter3d","name":"3","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"frame":null},{"x":[15700,20000,19800,17700,18000,23700,19000,22000,23200],"y":[97.4,97.5,95.4,92.8,93.3,92.5,99.7,97.9,77.9],"z":[12.5,5.53,7.03,3.89,5.05,2.29,4.45,4.42,14.51],"mode":"markers","type":"scatter3d","name":"4","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><em>Above we may observe the results of our clustering. This clustering follows a very expected pattern with countries becoming more ‘developed’ as they approach the nearest corner of the plot coinciding with high GDP, high literacy rate, and low infant mortality. An interesting thing to note is that the clusters are primarily divided along the GDP axis. This indicates that GDP per capita is the primary deciding factor in the ‘development’ of a nation. Another interesting thing to note is that high infant mortality is a phenomena experienced by almost exclusively the least ‘developed’ countries and these countries have it incredibly bad.</em></p>
<pre class="r"><code>kmeans2  %&gt;% group_by(cluster) %&gt;% summarise(countries = n_distinct(Country), regions = n_distinct(Region), avg_gdp = mean(GDP_per_capita, na.rm = T), avg_infant_mortality = mean(infant_mortality, na.rm=T), avg_literacy_rate = mean(literacy, na.rm=T))</code></pre>
<pre><code>## # A tibble: 4 x 6
##   cluster countries regions avg_gdp avg_infant_mortality avg_literacy_rate
##   &lt;fct&gt;       &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt;                &lt;dbl&gt;             &lt;dbl&gt;
## 1 1              20       4  31875                  4.75              98.4
## 2 2              21       7   4214.                36.9               84.0
## 3 3              17       6   9988.                13.8               94.1
## 4 4               9       5  19900                  6.63              93.8</code></pre>
<p><em>Here is a table summarizing the demographics of each cluster.</em></p>
</div>
<div id="who-is-in-what-cluster" class="section level2">
<h2>Who is in What Cluster?</h2>
<pre class="r"><code>#cluster 1
kmeans2 %&gt;% select(Country,cluster) %&gt;% filter(cluster == 1)</code></pre>
<pre><code>##           Country cluster
## 1       Australia       1
## 2         Austria       1
## 3         Belgium       1
## 4         Bermuda       1
## 5          Canada       1
## 6         Denmark       1
## 7         Finland       1
## 8          France       1
## 9         Germany       1
## 10      Hong Kong       1
## 11        Iceland       1
## 12        Ireland       1
## 13          Italy       1
## 14          Japan       1
## 15     Luxembourg       1
## 16         Norway       1
## 17     San Marino       1
## 18    Switzerland       1
## 19 United Kingdom       1
## 20  United States       1</code></pre>
<pre class="r"><code>#cluster 2
kmeans2 %&gt;% select(Country,cluster) %&gt;% filter(cluster == 2)</code></pre>
<pre><code>##               Country cluster
## 1             Albania       2
## 2          Azerbaijan       2
## 3            Cambodia       2
## 4            Colombia       2
## 5            Dominica       2
## 6  Dominican Republic       2
## 7             Ecuador       2
## 8           Guatemala       2
## 9               India       2
## 10          Indonesia       2
## 11            Lebanon       2
## 12           Maldives       2
## 13            Morocco       2
## 14             Panama       2
## 15            Romania       2
## 16            Senegal       2
## 17             Serbia       2
## 18          Sri Lanka       2
## 19             Turkey       2
## 20            Ukraine       2
## 21           Zimbabwe       2</code></pre>
<pre class="r"><code>#cluster 3
kmeans2 %&gt;% select(Country,cluster) %&gt;% filter(cluster == 3)</code></pre>
<pre><code>##       Country cluster
## 1   Argentina       3
## 2      Brazil       3
## 3    Bulgaria       3
## 4       Chile       3
## 5  Costa Rica       3
## 6     Croatia       3
## 7     Estonia       3
## 8     Hungary       3
## 9      Latvia       3
## 10  Lithuania       3
## 11   Malaysia       3
## 12     Mexico       3
## 13     Poland       3
## 14     Russia       3
## 15 Seychelles       3
## 16   Thailand       3
## 17    Uruguay       3</code></pre>
<pre class="r"><code>#cluster 4
kmeans2 %&gt;% select(Country,cluster) %&gt;% filter(cluster == 4)</code></pre>
<pre><code>##                Country cluster
## 1             Barbados       4
## 2               Greece       4
## 3               Israel       4
## 4                Malta       4
## 5             Portugal       4
## 6            Singapore       4
## 7             Slovenia       4
## 8                Spain       4
## 9 United Arab Emirates       4</code></pre>
<pre class="r"><code>require(maps)
require(viridis)

world_map &lt;- map_data(&quot;world&quot;)

world_map &lt;- world_map %&gt;% mutate(region = case_when(region == &quot;USA&quot; ~ &quot;United States&quot;, region != &quot;USA&quot; ~ region))

world_data &lt;- right_join(kmeans2, world_map, by = c(&quot;Country&quot; = &quot;region&quot;))</code></pre>
<p><em>Okay, so I know the instructions said don’t get carried away, but that’s exactly what I did. These plots could meet the ggplotting requirements since I just realized my two 3d plots are not, in fact, ggplots. Regardless, here I set out to plot our clusters on the world map that way we could visualize the distribution of 1st, 2nd and 3rd world nations as well as hyper-developed nations. To do this I used the package maps and specifically its world map dataframe. I then joined that dataframe with my kmeans2 dataframe to introduce the clusters variable into the world map dataframe. The issue that I ran into with this was how that dataframe named its geographic regions, more specifically, the discrepancies in country naming for the two datasets. I got around this issue for the case of the United States, as seen above, but I was unable to do this for the entire dataframe as it would involve manually finding and fixing all of the discrepancies.</em></p>
<pre class="r"><code>ggplot(world_data, aes(x = long, y = lat, group = group)) +
  geom_polygon(aes(fill=cluster), colour = &quot;white&quot;) + labs(title = &quot;Clusters of the World&quot;, subtitle = &quot;Cluster = Level of Development&quot;) + scale_x_continuous(breaks=seq(-200,200,50))</code></pre>
<p><img src="/project/project1_files/figure-html/unnamed-chunk-27-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><em>Here is the resulting plot of the world with the country’s color representing which cluster that nation fell into. Grey countries are countries for which the right_join could not produce a match. Inspecting this plot we can see that the clustered groupings of nations falls strongly in line with nations’ widely understood levels of development. For instance, we can see that most of western europe and north america fall into the same cluster while most of eastern europe and south america fall into a cluster of their own.</em></p>
<pre class="r"><code>ggplot(world_data, aes(x = long, y = lat, group = group)) +
  geom_polygon(aes(fill=GDP_per_capita), colour = &quot;white&quot;) + scale_fill_gradient(name = &quot;GDP per Capita&quot;, trans = &quot;log&quot;) + labs(title=&quot;GDP Per Capita of the World&quot;)</code></pre>
<p><img src="/project/project1_files/figure-html/unnamed-chunk-28-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><em>Here is a plot to compare to the previous clustered plot. This plot has nations shaded by their GDP. Inspecting the similarities between the clusters in the previous plot and the shades of blue on this plot, we can further reinforce the understanding of GDP as a strong indicator of a nation’s level of development.</em></p>
</div>

            
        <hr>         <div class="related-posts">
                <h5>Related Posts</h5>
                
              </div> 
            </div>
          </div>

   <hr>  <div class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">

    (function() {
      
      
      if (window.location.hostname == "localhost")
        return;

      var disqus_shortname = '';
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div> 
        </div>
      </div>
    </div>

    
    <footer>
  <div id="footer">
    <div class="container">
      <p class="text-muted">&copy; All rights reserved. Powered by <a href="https://gohugo.io/">Hugo</a> and
      <a href="http://www.github.com/nurlansu/hugo-sustain/">sustain</a> with ♥</p>
    </div>
  </div>
</footer>
<div class="footer"></div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="/js/docs.min.js"></script>
<script src="/js/main.js"></script>

<script src="/js/ie10-viewport-bug-workaround.js"></script>


    
  </body>
</html>
